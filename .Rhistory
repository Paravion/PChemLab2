y="Probability")
plot1 + scale_colour_manual("Lgend title", values = c("Stock Price", "Normal.D"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ncount.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"), args = list(mean=mean(zscore),
sd=1))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Lgend title", values = c("Stock Price", "Normal.D"))
dev.off()
#Satastic homework 1
#find a corporation from y! finace and compare with normal distribution
#coded by Pohao Huang (103032027)
require(quantmod)
require(ggplot2)
#I chose 3M for my homework
getSymbols("MMM",from= '1980-1-1')
price <- as.data.frame(MMM)
mean <- mean(price$MMM.Close)
price.n <- data.frame(price=price$MMM.Close-mean)
zscore <- (price.n$price - mean)/sd(price.n$price)
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ncount.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"), args = list(mean=mean(zscore),
sd=1))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Lgend title", values = c("black", "red"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ncount.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"), args = list(mean=mean(zscore),
sd=1))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Lgend title", values = c("black", "red"))
#Satastic homework 1
#find a corporation from y! finace and compare with normal distribution
#coded by Pohao Huang (103032027)
require(quantmod)
require(ggplot2)
#I chose 3M for my homework
getSymbols("MMM",from= '1980-1-1')
price <- as.data.frame(MMM)
mean <- mean(price$MMM.Close)
price.n <- data.frame(price=price$MMM.Close-mean)
zscore <- (price.n$price - mean)/sd(price.n$price)
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ndensity.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"), args = list(mean=mean(zscore),
sd=1))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Lgend title", values = c("red", "black"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ndensity.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"), args = list(mean=mean(zscore),
sd=1))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Lgend title", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ndensity.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"), args = list(mean=mean(zscore),
sd=1))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Lgend title", values = c("red", "black"))
price.n <- data.frame(price=price$MMM.Close-mean)
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ndensity.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Lgend title", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ndensity.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..ncount.. , color="Stock Price"), binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
price.n <- data.frame(price=price$MMM.Close-mean, p=dnorm(price$MMM.Close))
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
dev.off()
ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
price.n
head(price.n)
#Satastic homework 1
#find a corporation from y! finace and compare with normal distribution
#coded by Pohao Huang (103032027)
require(quantmod)
require(ggplot2)
#I chose 3M for my homework
getSymbols("MMM",from= '1980-1-1')
price <- as.data.frame(MMM)
mean <- mean(price$MMM.Close)
price.n <- data.frame(price=price$MMM.Close-mean, p=dnorm(price$MMM.Close))
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
price.n
head(price)
getSymbols("MMM",from= '1980-1-1')
price <- as.data.frame(MMM)
mean <- mean(price$MMM.Close)
price.n <- data.frame(price=price$MMM.Close, p=dnorm(price$MMM.Close))
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
head(price)
head(price.n)
price.n <- data.frame(price=price$MMM.Close, p=pnorm(price$MMM.Close))
price.n
quantile(price$MMM.Close)
y <- rnorm(0)
y <- rnorm(100)
z <- ecdf(y)
class(z\)
class(z)
y
plot(z)
y <- dnorm(100)
y <- rnorm(100)
z(y)
p <- ecdf(price$MMM.Close)
price.n <- data.frame(price=price$MMM.Close, p=p(price$MMM.Close))
plot1 <- ggplot(data=price.n, aes(x=price, y=p))+
geom_point(aes(color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_point(aes(y=p, color="Stock Price"))+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now)",
x="Prices ($100)",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
?quantile
y <- c(0.1:1)
y
y <- 0.1:1
y
seq(from=0.1, to=1, by=0.1)
y <- seq(from=0.1, to=1, by=0.1)
y <- c(seq(from=0.1, to=1, by=0.1))
y
p <- quantile(price$MMM.Close, probs = c(seq(from=0.1, to=1, by=0.1)))
price.n <- data.frame(price=price$MMM.Close, p=p(price$MMM.Close))
p
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..density.. ), color="Stock Price"), stat="bin",binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..density.. , color="Stock Price"), stat="bin",binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
#Satastic homework 1
#find a corporation from y! finace and compare with normal distribution
#coded by Pohao Huang (103032027)
require(quantmod)
require(ggplot2)
#I chose 3M for my homework
getSymbols("MMM",from= '1980-1-1')
price <- as.data.frame(MMM)
mean <- mean(price$MMM.Close)
price.n <- data.frame(price=price$MMM.Close-mean)
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..density.. , color="Stock Price"), stat="bin",binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
price.n <- data.frame(price=(price$MMM.Close-mean)/100)
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..density.. , color="Stock Price"), stat="bin",binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..density.. , color="Stock Price"), stat="bin",binwidth = 0.5)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y= ..density.. , color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(, color="Stock Price"), stat="bin",binwidth = 0.01)+
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(color="Stock Price"), stat="fill",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
#P_Chem Lab2 Exp2: Hydrolysis of Methyl Acetate
#Coded by Henry Lin
#T1 = 25 degree C, T2 = 35 degree
#read data
data0 <- read.csv("data/pchem2_exp2.csv")
head(data0)
data25 <- data0[data0$temp == 25 & data0$time != 58,] #drop the point at time=58
data35 <- data0[data0$temp == 35,]
#k = ln[(v_inf - v_0)/(v_inf - v_t)] / t-t_0
#t_0 = 0 , v_0 = 0
#k = - ln(v_inf - v_r) / t
#ln(v_inf - v_t) = - kt
#k
#make a new data frame for T1
v_inf <- data25[9,"naohV"]
log.v <- log(v_inf - data25$naohV)
data25 <- data.frame(data25, log.v)
plot(data25$time,data25$log.v)
data25 <- data25[1:7,]
#calulate k1 using linear modeling
model <- lm(formula = log.v ~ time, data = data25)
#ploting
plot(x=data25$time ,
y=data25$log.v ,
main = "ln(v_inf - v_t) vs t" ,
xlab = "t (sec)",
ylab = "ln(v_inf - v_t)")
abline(model, lwd = 2)
k1 <- coefficients(model)["time"]
data0 <- read.csv("data/pchem2_exp2.csv")
head(data0)
data25 <- data0[data0$temp == 25 & data0$time != 58,] #drop the point at time=58
data35 <- data0[data0$temp == 35,]
#k = ln[(v_inf - v_0)/(v_inf - v_t)] / t-t_0
data0 <- read.csv(".//data/pchem2_exp2.csv")
data0 <- read.csv("./data/pchem2_exp2.csv")
data0 <- read.csv("/data/pchem2_exp2.csv")
data0 <- read.csv("data/pchem2_exp2.csv")
data0 <- read.csv(".\\data\pchem2_exp2.csv")
getwd()
data0 <- read.csv("//data/pchem2_exp2.csv")
data0 <- read.csv("data/pchem2_exp2.csv")
data0 <- read.csv("./data/pchem2_exp2.csv")
data0 <- read.csv(".//data/pchem2_exp2.csv")
head(data0)
data0 <- read.csv("data/pchem2_exp2.csv")
head(data0)
data25 <- data0[data0$temp == 25 & data0$time != 58,] #drop the point at time=58
data0 <- read.csv("data\pchem2_exp2.csv")
data0 <- read.csv("\\data/pchem2_exp2.csv")
data0 <- read.csv(".\\data/pchem2_exp2.csv")
head(data0)
#P_Chem Lab2 Exp2: Hydrolysis of Methyl Acetate
#Coded by Henry Lin
#T1 = 25 degree C, T2 = 35 degree
require(ggplot2)
setwd("PChemLab2")
#read data
data0 <- read.csv("data/pchem2_exp2.csv")
head(data0)
data25 <- data0[data0$temp == 25 & data0$time != 58,] #drop the point at time=58
data35 <- data0[data0$temp == 35,]
#k = ln[(v_inf - v_0)/(v_inf - v_t)] / t-t_0
#t_0 = 0 , v_0 = 0
#k = - ln(v_inf - v_r) / t
#ln(v_inf - v_t) = - kt
#k
#make a new data frame for T1
v_inf <- data25[9,"naohV"]
log.v <- log(v_inf - data25$naohV)
data25 <- data.frame(data25, log.v)
plot(data25$time,data25$log.v)
data25 <- data25[1:7,]
#calulate k1 using linear modeling
model <- lm(formula = log.v ~ time, data = data25)
#ploting
plot(x=data25$time ,
y=data25$log.v ,
main = "ln(v_inf - v_t) vs t" ,
xlab = "t (sec)",
ylab = "ln(v_inf - v_t)")
abline(model, lwd = 2)
k1 <- coefficients(model)["time"]
k1
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(color="Stock Price"), stat="fill",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..density.., color="Stock Price"), stat="fill",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ndensity.., color="Stock Price"), stat="fill",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_histogram(aes(y = ..ndensity.., color="Stock Price"), stat="fill",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_histogram(aes(y = ..ndensity.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..density.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ndensity.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ndensity.., color="Stock Price"), stat="identify",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ndensity.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ndensity.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..density.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..density.., color="Stock Price"), stat="density",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ncount.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
dev.off()
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ncount.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
#plotting and ouput
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ncount.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
x="Prices",
y="Probability")
plot1 + scale_colour_manual("Legend", values = c("red", "black"))
dev.off()
#Satastic homework 1
#find a corporation from y! finace and compare with normal distribution
#coded by Pohao Huang (103032027)
require(quantmod)
require(ggplot2)
setwd("stathw.ysd")
#I chose 3M for my homework
getSymbols("MMM",from= '1980-1-1')
price <- as.data.frame(MMM)
mean <- mean(price$MMM.Close)
#sacling and noramlizing data
price.n <- data.frame(price=(price$MMM.Close-mean)/100)
#plotting and ouput
png("stat_hw1.png", width = 800, height =800)
plot1 <- ggplot(data=price.n, aes(x=price))+
geom_freqpoly(aes(y = ..ncount.., color="Stock Price"), stat="bin",binwidth = 0.01)+
stat_function(fun = dnorm, aes(color = "Normal.D"))+
labs(title = "Close Prices of 3M (1980-now) (Normalized)",
setwd("stathw.ysd")
setwd("stathw.ysd/")
